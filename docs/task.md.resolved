# üîÑ ConektaBots - Refatora√ß√£o Fase 1: Separa√ß√£o Front/Back

## Fase 1A: Reestrutura√ß√£o Backend (Clean Architecture)

- [x] **Task 1: Criar estrutura de diret√≥rios do backend**
  - Criar `backend/app/` com subdiret√≥rios: `api/v1/endpoints/`, `core/`, `models/`, `schemas/`, `services/`, `workers/`, `db/`
  - Criar `backend/tests/unit/`, `backend/tests/integration/`
  - Criar `backend/requirements/` com `base.txt`, `dev.txt`, `prod.txt`

- [x] **Task 2: Configura√ß√£o base e Database Layer**
  - Criar `app/core/config.py` com Pydantic Settings (env vars)
  - Criar `app/db/base.py` e `app/db/session.py` (SQLAlchemy 2.0)
  - Migrar modelos SQLModel ‚Üí SQLAlchemy 2.0 em `app/models/`
  - Setup Alembic para migrations

- [x] **Task 3: Criar Schemas Pydantic (DTOs)**
  - `app/schemas/bot.py` - BotCreate, BotUpdate, BotResponse
  - `app/schemas/rule.py` - RuleCreate, RuleUpdate, RuleResponse
  - `app/schemas/schedule.py` - ScheduleCreate, ScheduleUpdate, ScheduleResponse
  - `app/schemas/log.py` - LogResponse
  - `app/schemas/user.py` - UserCreate, UserLogin, UserResponse, Token

- [x] **Task 4: Implementar Services Layer**
  - `app/services/bot_service.py` - CRUD de bots + l√≥gica de neg√≥cio
  - `app/services/rule_service.py` - CRUD de regras
  - `app/services/schedule_service.py` - CRUD de agendamentos
  - `app/services/telegram_service.py` - Abstra√ß√£o do Telethon

- [x] **Task 5: Implementar Autentica√ß√£o (JWT)**
  - `app/core/security.py` - JWT tokens, password hashing (bcrypt)
  - `app/models/user.py` - Modelo User (SQLAlchemy)
  - `app/services/auth_service.py` - Login, register, token refresh
  - `app/api/deps.py` - get_db, get_current_user dependencies

- [x] **Task 6: Refatorar Endpoints (API Routers)**
  - `app/api/v1/endpoints/auth.py` - Login/Register/Refresh
  - `app/api/v1/endpoints/bots.py` - CRUD bots (REST API puro)
  - `app/api/v1/endpoints/rules.py` - CRUD regras
  - `app/api/v1/endpoints/schedules.py` - CRUD agendamentos
  - `app/api/v1/endpoints/analytics.py` - Logs/m√©tricas
  - `app/api/v1/router.py` - Registrar todos os routers

- [x] **Task 6.5: Tratamento de Exce√ß√µes Global**
  - `app/core/exceptions.py` - Exce√ß√µes customizadas (NotFound, Forbidden, Conflict, etc.)
  - `app/core/exception_handlers.py` - Handlers globais p/ FastAPI (HTTPException, ValidationError, Exception gen√©rica)
  - Respostas de erro padronizadas com `{"detail": ..., "error_code": ...}`
  - Logging estruturado de erros

- [x] **Task 7: Refatorar Workers**
  - `app/workers/bot_worker.py` - BotWorker usando services
  - `app/workers/scheduler_worker.py` - Scheduler usando services
  - Adaptar `manager.py` para nova estrutura

- [x] **Task 8: Criar main.py e integrar tudo**
  - `app/main.py` - FastAPI app com CORS, routers, lifespan
  - Atualizar `Dockerfile` para nova estrutura
  - Atualizar `docker-compose.yml`
  - Criar `.env.example`

- [x] **Task 9: Testes do Backend**
  - Testes unit√°rios para services
  - Testes de integra√ß√£o para API endpoints
  - Configurar pytest + fixtures
  - [x] **Support Swagger OAuth2 Login** (Added /token endpoint + python-multipart)

## Fase 1B: Frontend React (SPA)

- [ ] **Task 10: Setup Frontend (Vite + React + TypeScript)**
  - Inicializar projeto com Vite
  - Instalar depend√™ncias (TanStack Query, Axios, Zustand, shadcn/ui)
  - Estrutura de diret√≥rios

- [ ] **Task 11: Layout e Auth**
  - Componentes de Layout (Header, Sidebar, Layout)
  - Auth store (Zustand) + API client (Axios)
  - P√°ginas Login/Register
  - Route guards (prote√ß√£o de rotas)

- [ ] **Task 12: P√°ginas principais**
  - Dashboard com stats
  - Bot Management (list, create, edit, delete)
  - Rule Management (list, create, edit, delete)
  - Schedule Management
  - Logs/Analytics

## Fase 1C: Infraestrutura

- [ ] **Task 13: Docker + Nginx**
  - Dockerfile para frontend (multi-stage build)
  - Nginx config (reverse proxy API + SPA)
  - Atualizar docker-compose.yml (3 services: web, api, manager)

- [ ] **Task 14: CI/CD atualizado**
  - Atualizar GitHub Actions para nova estrutura
  - Build separado front/back
